<!DOCTYPE html>
<html
    class="no-js theme-{{ preferences.get_value('simple_style') or 'auto' }} center-aligment-{{ preferences.get_value('center_alignment') and 'yes' or 'no' }}"
    lang="{{ locale_rfc5646 }}" {% if rtl %} dir="rtl"{% endif %}>
<head>
    <meta charset="UTF-8"/>
    <meta name="description" content="Splendos">
    <meta name="keywords" content="Splendos, search, search engine, metasearch, meta search">
    <meta name="generator" content="searxng/{{ searx_version }}">
    <meta name="referrer" content="no-referrer">
    <meta name="robots" content="noarchive">
      <title>Splendos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="HandheldFriendly" content="True">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
   <!-- <title>{% block title %}{% endblock %}{{ instance_name }}</title>-->
    {% block meta %}{% endblock %}
    {% if rtl %}
        <link rel="stylesheet" href="{{ url_for('static', filename='css/searxng-rtl.min.css') }}" type="text/css"
              media="screen"/>
    {% else %}
        <link rel="stylesheet" href="{{ url_for('static', filename='css/searxng.min.css') }}" type="text/css"
              media="screen"/>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.min.css') }}" type="text/css"
              media="screen"/>
    {% endif %}
    {% block styles %}{% endblock %}
    <!--[if gte IE 9]>-->
    <script src="{{ url_for('static', filename='js/searxng.head.min.js') }}"
            client_settings="{{ client_settings }}"></script>
    <!--<![endif]-->
    {% block head %}
        <link title="{{ instance_name }}" type="application/opensearchdescription+xml" rel="search"
              href="{{ opensearch_url }}"/>
    {% endblock %}
    <link rel="icon" href="{{ url_for('static', filename='img/favicon.png') }}" sizes="any">
    <link rel="icon" href="{{ url_for('static', filename='img/favicon.svg') }}" type="image/svg+xml">
</head>
<body class="{{ endpoint }}_endpoint">
<main id="main_{{ self._TemplateReference__context.name|replace("simple/", "")|replace(".html", "") }}"
      class="{{ body_class }}">
    {% if errors %}
        <div class="dialog-error" role="alert">
            <a href="#" class="close" aria-label="close" title="close">×</a>
            <ul>
                {% for message in errors %}
                    <li>{{ message }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}


    <nav id="links_on_top">
        {%- from 'simple/icons.html' import icon_big -%}
        {%- block linkto_about -%}
       <!-- <a href="{{ url_for('preferences') }}"
               class="link_on_top_preferences">{{ icon_big('menu-outline') }}<span>Settings{{ _('Preferences') }}</span></a>
               class="link_on_top_about">{{ icon_big('information-circle-outline') }}<span>{{ _('About') }}</span></a>-->
        {%- endblock -%}
        {%- block linkto_donate -%}
            {%- if donation_url -%}
              <!--  <a href="{{ donation_url }}"
                   class="link_on_top_donate">{{ icon_big('heart-outline') }}<span>{{ _('Donate') }}</span></a>-->
            {%- endif -%}
        {%- endblock -%}
        {%- block linkto_preferences -%}
    </nav>

    {% block header %}
    {% endblock %}
           <!-- <a href="{{ url_for('preferences') }}"
               class="link_on_top_preferences">{{ icon_big('menu-outline') }}<span>{{ _('Preferences') }}</span></a>-->
        {%- endblock -%}
    {% block content %}
    {% endblock %}
</main>
<!---<footer>
    <p>{{ _('Powered by') }} <a href="{{ url_for('info', pagename='about') }}">Splendor</a> - {{ searx_version }}
        — {{ _('a privacy-respecting, open metasearch engine') }}</p>
</footer>-->
<!--[if gte IE 9]>-->
<script src="{{ url_for('static', filename='js/searxng.min.js') }}"></script>
   <script>
    const API_KEY = "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";

    async function generateText(message) {
      const url = "https://ai-connector.splendos.org/api/v1/chat";

      const headers = {
        "Content-Type": "application/json",
      };

      const data = {
        message,
      };

      try {
        const response = await fetch(url, {
          method: "POST",
          headers: headers,
          body: JSON.stringify(data),
        });

        if (response.ok) {
          const responseData = await response.json();
          const generatedText = responseData.response;
          return generatedText;
        } else {
          throw new Error(`${response.status} ${response.statusText}`);
        }
      } catch (error) {
        console.error(`Error: ${error.message}`);
      }
    }

    const btnGenerate = document.getElementById('btn-generate');

    btnGenerate.addEventListener('click', async () => {
      const inputPrompt = document.getElementById("inputPrompt").value;
      const messagesContainer = document.getElementById("messages");

      // Crear y agregar el mensaje del usuario al contenedor de mensajes
      const userMessageElement = document.createElement('div');
      userMessageElement.className = 'message user';
      userMessageElement.textContent = inputPrompt;
      messagesContainer.appendChild(userMessageElement);

      try {
         const generatedText = await generateText(inputPrompt);
         const webTitle = "Website:";
        const webUrl = "https://splendos.org/search";
        const modifiedText = generatedText + `<br><br>${webTitle} <br><br><a href="${webUrl}" target="_blank">${webUrl}</a>`;

        // Crear y agregar la respuesta del asistente al contenedor de mensajes
        const assistantMessageElement = document.createElement('div');
        assistantMessageElement.className = 'message assistant';
        assistantMessageElement.innerHTML = modifiedText;
        messagesContainer.appendChild(assistantMessageElement);

        // Limpiar el campo de entrada y mantener el scroll en la parte inferior
        document.getElementById("inputPrompt").value = '';
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
      } catch (error) {
        const errorMessageElement = document.createElement('div');
        errorMessageElement.className = 'message assistant';
        errorMessageElement.textContent = `Error: ${error.message}`;
        messagesContainer.appendChild(errorMessageElement);
      }
    });
  </script>



<!--<![endif]-->
</body>
</html>
